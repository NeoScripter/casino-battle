var P=Object.defineProperty;var _=(a,e,t)=>e in a?P(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var l=(a,e,t)=>_(a,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function I(a,e,t=document.body){const n=t.querySelector(a);if(!n)throw new Error(`Element not found: ${a}`);if(!(n instanceof e))throw new Error(`Expected ${e.name}, but found ${n.constructor.name}`);return n}const h={TEAM:"team",PARTICIPANT:"participant",REF:"ref",SCORE:"score",PERCENT:"percent",DEPOSIT:"deposit",TABLE:"table-parent-team",CAROUSEL:"carousel-team",TOTAL_SCORE:"total-score-team",WINNER:"carousel-winner-team"};class w{getWinnerImgContainer(e){return i(h.WINNER,"-",e.toString())}getTotalScore(e){return i(h.TOTAL_SCORE,"-",e.toString())}getParticipant(e,t){return i(h.TEAM,"-",e.toString(),"-",h.PARTICIPANT,"-",t.toString())}getRef(e,t){return i(h.TEAM,"-",e.toString(),"-",h.REF,"-",t.toString())}getScore(e,t){return i(h.TEAM,"-",e.toString(),"-",h.SCORE,"-",t.toString())}getPercent(e,t){return i(h.TEAM,"-",e.toString(),"-",h.PERCENT,"-",t.toString())}getDeposit(e,t){return i(h.TEAM,"-",e.toString(),"-",h.DEPOSIT,"-",t.toString())}}const E={REGULAR_CELL:"regular-cell",HEAD_CELL:"head-cell",TEXT_INPUT:"text-input-field",CHECKBOX_INPUT:"checkbox-input-field",RESULT_TABLE:"table-results-team"};function i(...a){return a.filter(e=>typeof e=="string").join("")}const T=new w;class U{populateTable(e){const t=document.getElementById(h.TABLE+"-"+e.toString());if(t==null)throw new Error("The table is not found");t.innerHTML="",t.classList.remove("winner-cols"),t.appendChild(this.createFirstColumn(e)),t.appendChild(this.createSecondColumn(e)),t.appendChild(this.createThirdColumn(e)),t.appendChild(this.createFourthColumn(e)),t.appendChild(this.createFifthColumn(e))}createFifthColumn(e){const t=document.createElement("div");t.appendChild(this.getTableHead("ДЕПОЗИТ"));for(let n=1;n<4;n++)t.appendChild(this.getDeposit(n,e));return t}createFourthColumn(e){const t=document.createElement("div");t.appendChild(this.getTableHead("ПРОЦЕНТ"));for(let n=1;n<4;n++)t.appendChild(this.getPercentCell(n,e));return t}createThirdColumn(e){const t=document.createElement("div");t.appendChild(this.getTableHead("БАЛЛ"));for(let n=1;n<4;n++)t.appendChild(this.getScoreCell(n,e));return t}createSecondColumn(e){const t=document.createElement("div");t.appendChild(this.getTableHead("РЕФ"));for(let n=1;n<4;n++)t.appendChild(this.getRef(n,e));return t}createFirstColumn(e){const t=document.createElement("div");t.appendChild(this.getTableHead("Участник"));for(let n=1;n<4;n++)t.appendChild(this.getTextInput("Участник "+n.toString(),n,e));return t}getTableHead(e){const t=this.extractTemplateContent(E.HEAD_CELL),n=t.querySelector("div");if(n==null)throw new Error("The template does not contain div element");return n.textContent=e,t}getPercentCell(e,t){const n=this.extractTemplateContent(E.REGULAR_CELL),r=n.querySelector("div");if(r==null)throw new Error("The template does not contain div element");return r.textContent="33.33%",r.id=T.getPercent(t,e),n}getScoreCell(e,t){const n=this.extractTemplateContent(E.REGULAR_CELL),r=n.querySelector("div");if(r==null)throw new Error("The template does not contain div element");return r.textContent="Балл: 1",r.id=T.getScore(t,e),n}getDeposit(e,t){const n=this.extractTemplateContent(E.CHECKBOX_INPUT),r=n.querySelector("input");if(r==null)throw new Error("The template does not contain input element");return r.id=T.getDeposit(t,e),n}getRef(e,t){const n=this.extractTemplateContent(E.CHECKBOX_INPUT),r=n.querySelector("input");if(r==null)throw new Error("The template does not contain input element");return r.id=T.getRef(t,e),n}getTextInput(e="Участник",t,n){const r=this.extractTemplateContent(E.TEXT_INPUT),s=r.querySelector("input");if(s==null)throw new Error("The template does not contain input element");return s.placeholder=e,s.id=T.getParticipant(n,t),r}extractTemplateContent(e){const t=document.getElementById(e);if(t==null||t.content==null)throw new Error("The template is empty or non existent");return t.content.cloneNode(!0)}populateWinnerTable(e,t,n,r){const s=document.getElementById(h.TABLE+"-"+e.toString()),o=document.getElementById(i(E.RESULT_TABLE,"-",e.toString()));o==null||s==null||(o.classList.add("!hidden"),s.innerHTML="",s.classList.remove("!hidden"),s.classList.add("winner-cols"),s.appendChild(this.createFirstWinnerColumn(e,r)),s.appendChild(this.createSecondWinnerColumn(e,n)),s.appendChild(this.createThirdWinnerColumn(e,t)))}createThirdWinnerColumn(e,t){const n=document.createElement("div");n.appendChild(this.getTableHead("ВЫПЛАТА"));for(let r=1;r<4;r++)n.appendChild(this.getWinnerScoreCell(r,e,t[r-1]));return n}createSecondWinnerColumn(e,t){const n=document.createElement("div");n.appendChild(this.getTableHead("%"));for(let r=1;r<4;r++)n.appendChild(this.getWinnerPercentCell(r,e,t[r-1]));return n}createFirstWinnerColumn(e,t){const n=document.createElement("div");n.appendChild(this.getTableHead("Участник"));for(let r=1;r<4;r++)n.appendChild(this.getWinnerParticipantCell(r,e,t[r-1]));return n}getWinnerParticipantCell(e,t,n){const r=this.extractTemplateContent(E.TEXT_INPUT),s=I("input",HTMLInputElement,r);return s.readOnly=!0,s.value=n,s.id=T.getParticipant(t,e),r}getWinnerScoreCell(e,t,n){const r=this.extractTemplateContent(E.REGULAR_CELL),s=I("div",HTMLDivElement,r);return s.textContent=`${n} РУБ.`,s.id=T.getScore(t,e),r}getWinnerPercentCell(e,t,n){const r=this.extractTemplateContent(E.REGULAR_CELL),s=I("div",HTMLDivElement,r);return s.textContent=`${n}%`,s.id=T.getPercent(t,e),r}}const A="images/carousel/",D=["bandit","bigbass","bonanza","dog","dogmulti","giza","mental","mummy","olympus","sugar"],N=new w;class B{constructor(e){l(this,"teamNumber");l(this,"parent");l(this,"figure");l(this,"images");l(this,"imageLength");l(this,"gap");l(this,"theta");l(this,"currImage");l(this,"bfc");l(this,"rotationInterval",null);l(this,"isRotating",!1);if(this.teamNumber=e,this.parent=document.getElementById(h.CAROUSEL+"-"+this.teamNumber.toString()),!this.parent)throw new Error("Carousel container not found!");if(this.figure=this.parent.querySelector("figure"),!this.figure)throw new Error("Carousel structure is missing `figure`!");this.images=this.figure.children,this.imageLength=this.images.length,this.gap=parseFloat(this.parent.dataset.gap||"10"),this.bfc="bfc"in this.parent.dataset,this.theta=this.imageLength>0?2*Math.PI/this.imageLength:0,this.currImage=0}init(){this.createCarousel(),this.setupCarousel(),this.initResize()}getCurrentImagePath(){if(!this.images||this.imageLength===0)return;const e=this.images[this.currImage%this.imageLength];if(!e)return;const t=e.querySelector("img");if(t)return t.src}createCarousel(){if(!this.parent||!this.figure)throw new Error("The figure element is missing!");this.figure.innerHTML="";for(const e of D){const t=document.createElement("div"),n=document.createElement("img");n.src=i(A,e,".png"),n.classList.add("border-3","border-white"),t.appendChild(n),this.figure.appendChild(t)}this.images=this.figure.children,this.imageLength=this.images.length,this.theta=this.imageLength>0?2*Math.PI/this.imageLength:0}setupCarousel(){if(!this.images||this.imageLength===0||!this.figure){console.error("No valid images found for the carousel!");return}const e=this.images[0];if(!e){console.error("First image not found!");return}const t=parseFloat(getComputedStyle(e).width);if(isNaN(t)||t<=0){console.error(" Invalid image width detected:",t);return}const n=t/(2*Math.tan(Math.PI/this.imageLength));this.figure.style.transformOrigin=`50% 50% ${-n}px`;for(let r=0;r<this.imageLength;r++){const s=this.images[r];s.style.padding=`0 ${this.gap}px`,s.style.transformOrigin=`50% 50% ${-n}px`,s.style.transform=`rotateY(${r*this.theta}rad)`,this.bfc&&(s.style.backfaceVisibility="hidden")}this.rotateCarousel(this.currImage)}rotateCarousel(e){if(!this.figure){console.error("Error: Figure element is missing!");return}if(isNaN(e)||isNaN(this.theta)||!isFinite(this.theta)){console.error("Invalid rotation value:",{imageIndex:e,theta:this.theta});return}this.figure.style.transform=`rotateY(${e*-this.theta}rad)`}startInfiniteRotation(){if(this.isRotating)return;this.isRotating=!0;let e=50;const t=Math.random()*5e3+4e3,n=Date.now(),r=()=>{this.currImage++,this.rotateCarousel(this.currImage);const s=Date.now()-n;e=50+s/t*950,s>=t?(clearInterval(this.rotationInterval),this.isRotating=!1,this.showWinner()):(clearInterval(this.rotationInterval),this.rotationInterval=window.setInterval(r,e))};this.rotationInterval=window.setInterval(r,e)}showWinner(){const e=N.getWinnerImgContainer(this.teamNumber),t=v(`#${e}`,HTMLDivElement),n=v("img",HTMLImageElement,t),r=this.getCurrentImagePath();r==null||this.parent==null||(n.src=r,t.classList.remove("!hidden"),this.parent.classList.add("absolute"),this.parent.style.opacity="0%",setTimeout(()=>{this.parent!=null&&(this.parent.classList.add("!hidden"),this.parent.style.opacity="100%",this.parent.classList.remove("absolute"))},500))}resetDisplay(){var n;const e=N.getWinnerImgContainer(this.teamNumber);v(`#${e}`,HTMLDivElement).classList.add("!hidden"),(n=this.parent)==null||n.classList.remove("!hidden")}initResize(){window.addEventListener("resize",()=>{this.setupCarousel()})}}function v(a,e,t=document.body){const n=t.querySelector(a);if(!n)throw new Error(`Element not found: ${a}`);if(!(n instanceof e))throw new Error(`Expected ${e.name}, but found ${n.constructor.name}`);return n}const p=new w,m={CALCULATE_BTN:"calculate-team",BONUS_INPUT:"bonus-team",PERCENT_INPUT:"percent-team",BET_INPUT:"bet-team",RESULT_TABLE:"table-results-team",PARENT_TABLE:"table-parent-team",XDIV:"carousel-winner-team"};class R{constructor(e){l(this,"teamNumber");l(this,"scores");l(this,"participants");l(this,"percents");l(this,"deposits");l(this,"refs");l(this,"score");l(this,"price");this.teamNumber=e,this.scores=[1,1,1],this.participants=["","",""],this.percents=[33.33,33.33,33.33],this.refs=[!1,!1,!1],this.deposits=[!1,!1,!1],this.score=null,this.price=null}init(){this.setupDepositEventListeners(),this.setupRefEventListeners(),this.setupCalculateBtnEvent()}fullReset(){this.scores=[1,1,1],this.participants=["","",""],this.percents=[33.33,33.33,33.33],this.refs=[!1,!1,!1],this.deposits=[!1,!1,!1],this.score=null,this.price=null,this.showTotalScoreTable(),this.hideXScoreDiv()}updateScore(){for(let e=0;e<3;e++)this.deposits[e]===!0?this.scores[e]=3:this.refs[e]===!0?this.scores[e]=2:this.scores[e]=1}setupCalculateBtnEvent(){const e=document.getElementById(i(m.CALCULATE_BTN,"-",this.teamNumber.toString())),t=document.getElementById(i(m.BONUS_INPUT,"-",this.teamNumber.toString())),n=document.getElementById(i(m.BET_INPUT,"-",this.teamNumber.toString())),r=document.getElementById(i(m.PERCENT_INPUT,"-",this.teamNumber.toString()));e==null||t==null||n==null||r==null||e.addEventListener("click",()=>{if(t.value==""||n.value==""||r.value=="")return;const s=parseFloat(t.value),o=parseFloat(n.value),c=parseFloat(r.value);if(isNaN(s)||isNaN(o)||isNaN(c))return;const g=Math.ceil(s/o);this.score=g,s<=c?this.price=1500:this.price=Math.ceil(s-c),this.showXScoreDiv(g.toString())})}showXScoreDiv(e){const t=document.getElementById(i(m.XDIV,"-",this.teamNumber.toString()));if(t==null)throw new Error("total score is not found");const n=t.querySelector(".text-center");if(n==null)throw new Error("xDiv is not found");const r=t.querySelector("span");if(r==null)throw new Error("span is not found");n.classList.remove("hidden"),r.textContent=e}hideXScoreDiv(){const e=document.getElementById(i(m.XDIV,"-",this.teamNumber.toString()));if(e==null)throw new Error("total score is not found");const t=e.querySelector(".text-center");if(t==null)throw new Error("xDiv is not found");t.classList.add("hidden")}hideTotalScoreTable(){const e=p.getTotalScore(this.teamNumber),t=document.getElementById(e);if(t==null)throw new Error("total score is not found");t.classList.add("!hidden")}showTotalScoreTable(){const e=p.getTotalScore(this.teamNumber),t=document.getElementById(e);if(t==null)throw new Error("total score is not found");t.classList.remove("!hidden"),t.classList.remove("winner-text")}resetCalculateInputFields(){const e=document.getElementById(i(m.BONUS_INPUT,"-",this.teamNumber.toString())),t=document.getElementById(i(m.BET_INPUT,"-",this.teamNumber.toString())),n=document.getElementById(i(m.PERCENT_INPUT,"-",this.teamNumber.toString()));e==null||t==null||n==null||(e.value="",t.value="",n.value="")}showCalculateResult(){const e=document.getElementById(i(m.RESULT_TABLE,"-",this.teamNumber.toString())),t=document.getElementById(i(m.PARENT_TABLE,"-",this.teamNumber.toString()));e==null||t==null||(e.classList.remove("!hidden"),t.classList.add("!hidden"))}hideCalculateResult(){const e=document.getElementById(i(m.RESULT_TABLE,"-",this.teamNumber.toString())),t=document.getElementById(i(m.PARENT_TABLE,"-",this.teamNumber.toString()));e==null||t==null||(e.classList.add("!hidden"),t.classList.remove("!hidden"))}resetTotalScoreDisplay(){const e=p.getTotalScore(this.teamNumber),t=document.getElementById(e);if(t==null)throw new Error("total score is not found");t.textContent="Общий балл: 3"}updateDisplayScore(){const e=this.scores.reduce((s,o)=>s+o,0),t=Math.floor(100/e*100)/100,n=p.getTotalScore(this.teamNumber),r=document.getElementById(n);if(r==null)throw new Error("total score is not found");r.textContent=`Общий балл: ${e}`;for(let s=1;s<4;s++){const o=p.getScore(this.teamNumber,s),c=p.getPercent(this.teamNumber,s),g=document.getElementById(o),C=document.getElementById(c);if(g==null||C==null)throw new Error("score or percent are not found");g.textContent=`Балл: ${this.scores[s-1]}`;const S=Math.floor(this.scores[s-1]*t*100)/100;this.percents[s-1]=S,C.textContent=`${S}%`}}setupDepositEventListeners(){for(let e=1;e<4;e++){const t=p.getDeposit(this.teamNumber,e),n=document.getElementById(t);if(n==null)throw new Error("deposit is not found");n.addEventListener("change",()=>{this.updateDeposits(),this.updateScore(),this.updateDisplayScore()})}}setupRefEventListeners(){for(let e=1;e<4;e++){const t=p.getRef(this.teamNumber,e),n=document.getElementById(t);if(n==null)throw new Error("ref is not found");n.addEventListener("change",()=>{this.updateRefs(),this.updateScore(),this.updateDisplayScore()})}}updateRefs(){for(let e=1;e<4;e++){const t=p.getRef(this.teamNumber,e),n=document.getElementById(t);if(n==null)throw new Error("ref is not found");this.refs[e-1]=n.checked}}updateDeposits(){for(let e=1;e<4;e++){const t=p.getDeposit(this.teamNumber,e),n=document.getElementById(t);if(n==null)throw new Error("deposit is not found");this.deposits[e-1]=n.checked}}saveParticipantsNames(){for(let e=1;e<4;e++){const t=p.getParticipant(this.teamNumber,e),n=document.getElementById(t);if(n==null)throw new Error("element is not found");this.participants[e-1]=n.value}}}const f={BTN_LAUNCH_CAROUSEL:"rotate-btn",BTN_RESET:"reset-btn",BTN_RESULTS:"results-btn",RESULT_POPUP:"result-popup",RESULT_POPUP_CELL:"result-popup-cell"},L=new U,u=new R(1),d=new R(2),y=new B(1),b=new B(2),O=new w;class x{constructor(){l(this,"memo");this.memo=new Map}init(){this.setupBtnEventListener(),L.populateTable(1),L.populateTable(2),u.init(),d.init(),y.init(),b.init()}showRestartBtn(){const e=document.getElementById(f.BTN_RESET),t=document.getElementById(f.BTN_LAUNCH_CAROUSEL);t==null||e==null||(e.classList.remove("!hidden"),t.classList.add("!hidden"))}showLaunchCarouselBtn(){const e=document.getElementById(f.BTN_RESET),t=document.getElementById(f.BTN_LAUNCH_CAROUSEL);t==null||e==null||(e.classList.add("!hidden"),t.classList.remove("!hidden"))}setupBtnEventListener(){const e=document.getElementById(f.BTN_LAUNCH_CAROUSEL),t=document.getElementById(f.BTN_RESET),n=document.getElementById("calculate-team-1"),r=document.getElementById("calculate-team-2"),s=document.getElementById(f.BTN_RESULTS);if(e==null||t==null||n==null||r==null||s==null)throw new Error("One of the buttons is undefined");e.addEventListener("click",()=>{e.disabled=!0,u.resetCalculateInputFields(),d.resetCalculateInputFields(),this.resetWinner(),this.launchCarousel(),u.showCalculateResult(),d.showCalculateResult(),u.saveParticipantsNames(),d.saveParticipantsNames(),setTimeout(()=>{this.showRestartBtn(),e.disabled=!1},1e4)}),t.addEventListener("click",()=>{this.cleanup(),u.fullReset(),d.fullReset()}),r.addEventListener("click",()=>{setTimeout(()=>this.assignWinner(),100)}),n.addEventListener("click",()=>{setTimeout(()=>this.assignWinner(),100)}),s.addEventListener("click",()=>this.showResultPopup());const o=document.getElementById(f.RESULT_POPUP);if(o==null)throw new Error("result popup is undefined");o.addEventListener("click",c=>{c.target===c.currentTarget&&(o.style.opacity="0%",setTimeout(()=>{o.classList.add("hidden"),o.style.opacity="100%"},500))})}showResultPopup(){const e=document.getElementById(f.RESULT_POPUP),t=document.getElementById(f.RESULT_POPUP_CELL);if(e==null||t==null)throw new Error("result popup is undefined");const n=e.querySelector("div");if(n==null)throw new Error("result popup child is undefined");n.innerHTML="",this.memo.forEach((r,s)=>{const o=t.content.cloneNode(!0),c=o.querySelector("div.text-center");if(c==null)return;c.textContent=s,n.appendChild(o);const g=t.content.cloneNode(!0),C=g.querySelector("div.text-center");C!=null&&(C.textContent=`${r} РУБ.`,n.appendChild(g))}),e.style.opacity="0%",e.classList.remove("hidden"),e.style.opacity="100%"}cleanup(){L.populateTable(1),L.populateTable(2),y.resetDisplay(),b.resetDisplay(),u.hideCalculateResult(),d.hideCalculateResult(),u.init(),d.init(),u.resetTotalScoreDisplay(),d.resetTotalScoreDisplay(),u.resetCalculateInputFields(),d.resetCalculateInputFields(),this.showLaunchCarouselBtn(),this.resetWinner()}launchCarousel(){y.startInfiniteRotation(),b.startInfiniteRotation()}assignWinner(){if(u.score!=null&&d.score!=null){const e=document.getElementById("container-team-1"),t=document.getElementById("container-team-2");if(e==null||t==null)return;u.score>d.score?(e.classList.add("winner"),t.classList.add("loser"),this.saveWins(u.price,u.participants,u.percents,1)):u.score<d.score&&(e.classList.add("loser"),t.classList.add("winner"),this.saveWins(d.price,d.participants,d.percents,2))}}saveWins(e,t,n,r){if(e==null)throw new Error("the price is null");const s=[];for(let c=0;c<3;c++){const g=t[c],C=n[c],S=Math.ceil(e/100*C);s.push(S),this.memo.set(g,S.toString())}L.populateWinnerTable(r,s,n,t);const o=`Выплата на команду: ${e} РУБ.`;this.showTotalScore(r,o)}showTotalScore(e,t){const n=O.getTotalScore(e),r=document.getElementById(n);if(r==null)throw new Error("total score is not found");r.classList.remove("!hidden"),r.classList.add("winner-text"),r.textContent=t}resetWinner(){if(u.score!=null&&d.score!=null){const e=document.getElementById("container-team-1"),t=document.getElementById("container-team-2");if(e==null||t==null)return;e.classList.remove("winner"),t.classList.remove("loser"),e.classList.remove("loser"),t.classList.remove("winner")}}}const H=new x;H.init();
